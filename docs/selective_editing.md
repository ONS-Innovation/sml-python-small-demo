Overall method
=============

The main function validates the input DataFrames and Parameters before stepping 
the individual question data through the single question scoring sub-function. 

NB: The single question scoring sub-function is private to the main method and must 
not be called independently.

Once individual question scores are known, they are combined using the specified combination 
method to create a final score using the following calculations:

>##### Maximum
>Final score = Maximum question score calculated for the reference.

>##### Mean
>Final score = Mean of the question scores calculated for the reference.

>##### Weighted
>Final score = Sum of the weighted scores calculated for the reference / 
               Sum of the question weights provided for the reference.

>##### Minkowski
>Final score = Sum of the minkowski scores calculated for the reference **
               (1 / {MINKOWSKI_DISTANCE})

Finally, a Boolean selective editing marker is generated by comparing the final score to the threshold
parameter provided, with True being assigned to those references whose score is _**less than**_ the threshold.


Required Inputs
---------------

* **input_dataframe**: (DataFrame) Input DataFrame.
* **reference_col**: (String) Column that holds the contributor reference.
* **design_weight_col**: (String) Column that holds the design weight for the contributor.
* **threshold_col**: (String) Column that holds the threshold for the contributor.
* **question_list**: (List of strings) Column that holds the question names that are to be scored.
* **combination_method**: (String) The combination method to be used, one of 'maximum', 'mean', 'weighted' or 'minkowski'; Defaults to 'maximum'
* **minkowski_distance**: (Float) The minkowski distance to be used when calculating final score with the minkowski combination method; Defaults to 0.


Input Dataframe requirements
----------------------------------

To allow the method to locate the various data it requires for calculating each question's score,
the question data columns must abide by the following convention:

* {base_name}_ar" : The actual return column
* {base_name}_pv" : The predicted value column
* {base_name}_apv" : The auxiliary predicted value column
* {base_name}_sf" : The standardising factor column
* {base_name}_wt" : The question weight column - Only needed for the 'weighted' combination method.

with base_name being a base question name present in the question_list parameter supplied.

Either a Predicted Value or an Auxiliary Predicted Value must be provided for each question to be scored.

If using the 'weighted' combination method, you must provide a question weight column for each question to be scored.

Examples of usage
-----------------

>### Example 1 - Single question processing.
>If we wanted to use the 'maximum' combination method to process rows with a single question
called 'the_question': <br>
The **question_list** parameter would be supplied as ["the_question"], <br>
The **combination_method** parameter would be supplied as "maximum", <br>
The **input_dataframe** must include the following columns in addition to the basic cols required:  <br>
"question_1_ar", "question_1_pv", "question_1_apv", "question_1_sf", <br>
"question_2_ar", "question_2_pv", "question_2_apv", "question_2_sf", <br>
"question_3_ar", "question_3_pv", "question_3_apv", "question_3_sf" <br>   

<br>

>### Example 2 - Combination score using 'mean' method.
>If we wanted to use the 'mean' combination method to process rows with three questions
called 'question_1', 'question_2' and 'question_3': <br>
The **question_list** parameter would be supplied as ["question_1", "question_2", "question_3"], <br>
The **combination_method** parameter would be supplied as "mean", <br>
The **input_dataframe** must include the following columns in addition to the basic cols required: <br>
"question_1_ar", "question_1_pv", "question_1_apv", "question_1_sf", <br>
"question_2_ar", "question_2_pv", "question_2_apv", "question_2_sf", <br>
"question_3_ar", "question_3_pv", "question_3_apv", "question_3_sf" <br>

<br>

>### Example 3 - Combination score using 'weighted' method.
>If we wanted to use the 'weighted' combination method to process rows with two questions
called 'question_one' and 'question_two':  <br>
The **question_list** parameter would be supplied as ["question_one", "question_two"], <br>
The **combination_method** parameter would be supplied as "weighted" <br>
The **input_dataframe** must include the following columns in addition to the basic cols required: <br>
"question_one_ar", "question_one_pv", "question_one_apv", "question_one_sf", "question_one_wt", <br>
"question_two_ar", "question_two_pv", "question_two_apv", "question_two_sf", "question_two_wt" <br>

<br>

>### Example 4 - Combination score using 'minkowski' method.
>If we wanted to use the 'minkowski' combination method to process rows with two questions
called 'question_one' and 'question_two':   <br>
The **question_list** parameter would be supplied as ["question_one", "question_two"],  <br>
The **combination_method** parameter would be supplied as "minkowski",  <br>
The **minkowski_distance** parameter would be supplied as a non-zero float,  <br>
The **input_dataframe** must include the following columns in addition to the basic cols required:  <br>
"question_one_ar", "question_one_pv", "question_one_apv", "question_one_sf",  <br>
"question_two_ar", "question_two_pv", "question_two_apv", "question_two_sf"  <br>


Outputs
-------

The key output columns in the returned dataframe are:
* **reference**: (String) The reference column as defined by the reference_col param,
* **threshold** (Float) The threshold column as defined by the threshold_col param,
* **final_score** (Float) The final score used in threshold comparison,
* **selective_editing_marker** (Boolean) True is final score is less that the threshold, else False.



Overview of Sub-functions
-------------------------

### 1. process_single_question

Calculates the base selective editing score of a given question:

>(100 * abs({ACTUAL_RETURN} - {PREDICTED_VALUE})
     * {DESIGN_WEIGHT} /{STANDARDISING_FACTOR)

If the predicted value is not provided, the function will use the auxiliary predicted 
value instead and mark the predicted marker column ({question_name}_pm) as boolean False.

If the 'weighted' combination method has been used, a weighted score column will be returned 
in addition to the standard score. This will be titled {question_name}_wts and is calculated thus:

>Weighted Score = Base Score * {QUESTION_WEIGHT}


If the 'minkowski' combination method has been used, a minkowski score column will be returned 
in addition to the standard score. This will be titled {question_name}_mks and is calculated thus:

>Minkowski Score = Base Score ** {MINKOWSKI_DISTANCE}
